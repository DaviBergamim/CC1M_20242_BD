DROP SCHEMA IF EXISTS Estudo_de_casos_2;
CREATE SCHEMA Estudo_de_casos_2;
USE Estudo_de_casos_2;

CREATE TABLE IF NOT EXISTS PASSAGEIROS (
    PASSAGEIRO_COD INT PRIMARY KEY,
    PASSAGEIRO_NOME VARCHAR(100) NOT NULL,
    PASSAGEIRO_CPF VARCHAR(11) NOT NULL UNIQUE,
    PASSAGEIRO_TELEFONE VARCHAR(20),
    PASSAGEIRO_RESIDENCIA TEXT
);

CREATE TABLE IF NOT EXISTS AEROPORTOS (
    AEROPORTO_COD INT PRIMARY KEY,
    AEROPORTO_NOME VARCHAR(50) NOT NULL,
    AEROPORTO_CIDADE VARCHAR(100),
    AEROPORTO_REGIAO VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS AERONAVES (
    AERONAVE_COD INT PRIMARY KEY,
    AERONAVE_TIPO VARCHAR(50) NOT NULL,
    AERONAVE_CAPACIDADE INT
);

CREATE TABLE IF NOT EXISTS FUNCIONARIOS (
    FUNCIONARIO_COD INT PRIMARY KEY,
    FUNCIONARIO_NOME VARCHAR(100) NOT NULL,
    FUNCIONARIO_FUNCAO VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS VOOS (
    VOO_COD INT PRIMARY KEY,
    VOO_ORIGEM INT NOT NULL,
    VOO_DESTINO INT NOT NULL,
    VOO_PARTIDA TIME,
    VOO_HORA_CHEGADA TIME,
    AERONAVE_COD INT,
    CONSTRAINT FK_VOO_ORIGEM FOREIGN KEY (VOO_ORIGEM) REFERENCES AEROPORTOS(AEROPORTO_COD),
    CONSTRAINT FK_VOO_DESTINO FOREIGN KEY (VOO_DESTINO) REFERENCES AEROPORTOS(AEROPORTO_COD),
    CONSTRAINT FK_AERONAVE FOREIGN KEY (AERONAVE_COD) REFERENCES AERONAVES(AERONAVE_COD)
);

CREATE TABLE IF NOT EXISTS RESERVAS (
    RESERVA_COD INT PRIMARY KEY,
    PASSAGEIRO_COD INT,
    VOO_COD INT,
    RESERVA_DATA_HORA DATE,
    CONSTRAINT FK_PASSAGEIRO FOREIGN KEY (PASSAGEIRO_COD) REFERENCES PASSAGEIROS(PASSAGEIRO_COD),
    CONSTRAINT FK_VOO FOREIGN KEY (VOO_COD) REFERENCES VOOS(VOO_COD)
);

CREATE TABLE IF NOT EXISTS OPERACOES_VOO (
    VOO_COD INT,
    FUNCIONARIO_COD INT,
    PRIMARY KEY (VOO_COD, FUNCIONARIO_COD),
    CONSTRAINT FK_VOO_OP FOREIGN KEY (VOO_COD) REFERENCES VOOS(VOO_COD),
    CONSTRAINT FK_FUNC_OP FOREIGN KEY (FUNCIONARIO_COD) REFERENCES FUNCIONARIOS(FUNCIONARIO_COD)
);
